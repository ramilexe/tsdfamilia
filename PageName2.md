# Описание программы терминала. #

1.Программа состоит из нескольких меню: сканирование, товары, инв-ция,накладные,настройки
2.Сканирование - запуск однопроходной режим
список товаров, поиск по баркоду (можно сканировать), коду Нав-н. Можно распечатать выбранный шаблон.
в меню сканирование список пунктов:
- Поиск по ШК -> ввод ШК < enter >-поиск, CLR -назад
- поиск по коду Нав-н -> ввод кода < enter >-поиск, CLR -назад
- печать -> выбрать шаблон (список шаблонов для товара)->Печатать
4. Инв-ция: редактирование (доб, удалить позицию)
5. Накладные - аналогичное инв-ции действия.
6. Настройки - ручное изменение настроек, поиск и установка БТ-принтера, другие необходимые действия.
7. Переброски
По звукам:
Предлагаю тогда передавать еще табличку код-звука - название файла и сами файлы отдельно (или только новые файлы звуков).

>там поиск если с клавиатуры ввод ,то по коду Навижен, если пришл ШК со сканера, то по баркоду
При нахождении товара мы попадаем в окно однопроходного сканирования и далее выполняем нужные действия?
Тогда поиск по баркоду не нужен. Так и так если отсканировали и нашли, тоже и получится.
Тогда остается поиск по коду нав-н. Если нашли, переходим к обработке действий по товару, правильно?
Если нет - соообщение "товар не найден", аналогично сканированию.

>Справочники:
>товары:
>товар1 - переброска5 - В справочнике товаров  указывается только код действия - переброска.
>переброски: - отдельная таблица
>переборска5-товар1-10 шт.
Структура:
Номер переброски - код товара (навизион или лучше ШК), кол-во ЗАДАННОЕ, прочие поля, кол-во ОТСКАНИРОВАНОЕ (по умолчанию 0)

Процесс.
1) Сканируем. ->код переброска
2) Смотрим кол-во, по каждой переброске в таб.перебросок.
3)Если по I-ой переброске кол-во  отсканир.  меньше , чем кол-во ЗАДАННОЕ, добавляем +1, выводим лейбл
4)Если по I-ой переброске кол-во  отсканир.  РАВНО,  кол-во ЗАДАННОЕ,  выводим финальный лейбл - неавтоматически!
Выведен окно, что переброска закончена. 2 кнопки: Печать финального лейбла и Назад.
5)Если есть другие переброски, повторяем 3,4,5

Выгружаем на сервер таблицу перебросок.



Особенности обновления программы терминала.
Для обновления БД копируется полностью файл базы. Для возможности быть записанным на устройство должно быть соблюдено 2 условия:
1)Терминал находится в Crade и установлена связь activesync
2)Соединение с БД на терминале закрыто. Для этого нужно или закрыть программу, или выйти в главное меню -
соединение будет закрыто, сохраненные данные в памяти будут очищены.

Однопроходное сканирование.
В БД будет указано а)код действия: 1 байт, битовая маска каждого кода соответствует 2 в степени номера кода.
При сложении И получаем все необходимые действия. 0 - нет действия.
б) тип шаблона. Для каждого действия предусмотрим до 8 шаблонов. На 8 действий получаем 32 бита.
8 шаблонов, выбираем только один - 3 разряда (2^3 = 8)
Для получения нужного числа: код шаблона умножаем на код каждого действия (логический сдвиг влево)
и складываем все коды (получаем пересечение всех шаблонов).
в)Код звука. На мой взгляд нет необходимости хранить в БД код звука - можно создать набор стандартных звуков, в зависимости от типа действия. Либо 2-ой вариант кодироваться будет аналогично коду шаблона.
Шаблоны и звуки должны будут копироваться из центрального офиса вместе с базой товаров.

Описание процесса.
1. Сотрудник запускает программу, открывает меню сканирование.
сканирует товар.
2. Ищем по ШК сначала в кэшированной копии в памяти строку товара. Находим - отлично, переходим к действию п.3
В памяти не найдено - считываем из БД, кэшируем в памяти. Не найдено - выводим сообщение (с кнопкой ЗАКРЫТЬ) и звук.
3. Определяем необходимые типы действий.
4. Определяем звук.
5. Для каждого номера действия выполняем действие, выводим звук, выводим сообщение на экран, нужным цветом (на нужном фоне)
5.1 Действие 1 - печать ценника: берем нужный шаблон, выводим на блютуз принтер (соединение с принтером предварительно настроено в настройках. Запомнено номер устройства). В отдельную БД (ScannedResults) записан ШК, код выполненного действия, дата и время, кол-во раз. Выводим звук.
5.1 Действие 2: инвентаризация: печатаем нужный шаблон, добавляем в базу ScannedResults,Выводим звук..
5.2.Накладные на Возврат: печатаем нужный шаблон, добавляем в базу ScannedResults,Выводим звук..
5.3 Прочие действия - аналогично.
...
6. Готовы к следующему сканированию.
7. Выход из программы.
8. Выгрузка результатов с терминала
8.1 Выйти в главное меню или закрыть программу.
8.2 На компьютере в программе сервера выбрать выгрузка данных с терминала.
База Scanned results будет скопирована с терминала на комп. Загруженные результаты могут быть переданы дальше.
Конец.